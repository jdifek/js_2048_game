var t={};class s{static WIN_NUMBER=2048;static STATUS_PLAYING="playing";static STATUS_IDLE="idle";static STATUS_LOSE="lose";static STATUS_WIN="win";static DEFAULT_STATE=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];constructor(t=s.DEFAULT_STATE){this.initialState=t,this.state=this.deepCloneArray(this.initialState),this.status=s.STATUS_IDLE,this.score=0}deepCloneArray(t){return t.map(t=>[...t])}moveLeft(){if(this.status===s.STATUS_WIN||this.status===s.STATUS_LOSE||this.status===s.STATUS_IDLE)return;let t=JSON.stringify(this.state);for(let t=0;t<this.state.length;t++){let e=this.state[t].filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,e[t]===s.WIN_NUMBER&&(this.status=s.STATUS_WIN),this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<this.state[t].length;)e.push(0);this.state[t]=e}t!==JSON.stringify(this.state)&&this.addRandomTile(),this.movesAvailable()||(this.status=s.STATUS_LOSE)}moveRight(){if(this.status===s.STATUS_WIN||this.status===s.STATUS_LOSE||this.status===s.STATUS_IDLE)return;let t=JSON.stringify(this.state);for(let t=0;t<this.state.length;t++){let e=this.state[t].filter(t=>0!==t);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&(e[t]*=2,e[t-1]=0,e[t]===s.WIN_NUMBER&&(this.status=s.STATUS_WIN),this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<this.state[t].length;)e.unshift(0);this.state[t]=e}t!==JSON.stringify(this.state)&&this.addRandomTile(),this.movesAvailable()||(this.status=s.STATUS_LOSE)}moveUp(){if(this.status===s.STATUS_WIN||this.status===s.STATUS_LOSE||this.status===s.STATUS_IDLE)return;let t=JSON.stringify(this.state);for(let t=0;t<this.state[0].length;t++){let e=[];for(let s=0;s<this.state.length;s++)0!==this.state[s][t]&&e.push(this.state[s][t]);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,e[t]===s.WIN_NUMBER&&(this.status=s.STATUS_WIN),this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<this.state.length;)e.push(0);for(let s=0;s<this.state.length;s++)this.state[s][t]=e[s]}t!==JSON.stringify(this.state)&&this.addRandomTile(),this.movesAvailable()||(this.status=s.STATUS_LOSE)}moveDown(){if(this.status===s.STATUS_WIN||this.status===s.STATUS_LOSE||this.status===s.STATUS_IDLE)return;let t=JSON.stringify(this.state);for(let t=0;t<this.state[0].length;t++){let e=[];for(let s=0;s<this.state.length;s++)0!==this.state[s][t]&&e.push(this.state[s][t]);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&(e[t]*=2,e[t-1]=0,e[t]===s.WIN_NUMBER&&(this.status=s.STATUS_WIN),this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<this.state.length;)e.unshift(0);for(let s=0;s<this.state.length;s++)this.state[s][t]=e[s]}t!==JSON.stringify(this.state)&&this.addRandomTile(),this.movesAvailable()||(this.status=s.STATUS_LOSE)}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status=s.STATUS_PLAYING,this.addRandomTile(),this.addRandomTile()}restart(){this.state=this.deepCloneArray(this.initialState),this.score=0,this.status=s.STATUS_IDLE}addRandomTile(){let t=[];for(let s=0;s<this.state.length;s++)for(let e=0;e<this.state[s].length;e++)0===this.state[s][e]&&t.push({x:s,y:e});let s=Math.floor(Math.random()*t.length),{x:e,y:i}=t[s];this.state[e][i]=.9>Math.random()?2:4}movesAvailable(){for(let t=0;t<this.state.length;t++)for(let s=0;s<this.state[t].length;s++)if(0===this.state[t][s]||t>0&&this.state[t][s]===this.state[t-1][s]||t<this.state.length-1&&this.state[t][s]===this.state[t+1][s]||s>0&&this.state[t][s]===this.state[t][s-1]||s<this.state[t].length-1&&this.state[t][s]===this.state[t][s+1])return!0;return!1}}const e=new(t=s),i=document.querySelector(".button"),a=document.querySelector(".game-score"),h=document.querySelectorAll(".field-cell");function l(t){switch(t.key){case"ArrowDown":e.moveDown();break;case"ArrowUp":e.moveUp();break;case"ArrowRight":e.moveRight();break;case"ArrowLeft":e.moveLeft();break;default:return}r()}function r(){a.textContent=e.getScore(),function(){let t=e.getState();for(let s=0;s<t.length;s++)for(let e=0;e<t[s].length;e++){let i=h[s*t.length+e];i.textContent=0===t[s][e]?"":t[s][e],i.className="field-cell",0!==t[s][e]&&i.classList.add(`field-cell--${t[s][e]}`)}}(),function(){let s=e.getStatus(),i=document.querySelector(".message-container");i.querySelectorAll(".message").forEach(t=>t.classList.add("hidden")),s===t.STATUS_LOSE?i.querySelector(".message-lose").classList.remove("hidden"):s===t.STATUS_WIN?i.querySelector(".message-win").classList.remove("hidden"):s===t.STATUS_IDLE&&i.querySelector(".message-start").classList.remove("hidden")}()}i.addEventListener("click",()=>{i.classList.toggle("start"),i.classList.toggle("restart"),i.classList.contains("restart")?(i.textContent="Restart",e.start(),r(),document.addEventListener("keydown",l)):(i.textContent="Start",e.restart(),r())});
//# sourceMappingURL=index.76816a63.js.map
