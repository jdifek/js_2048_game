!function(){var t={};function e(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,a=Array(e);s<e;s++)a[s]=t[s];return a}var a=function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_STATE;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.initialState=t,this.state=this.deepCloneArray(this.initialState),this.status=e.STATUS_IDLE,this.score=0}return t=[{key:"deepCloneArray",value:function(t){return t.map(function(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,void 0);var a=Object.prototype.toString.call(t).slice(8,-1);if("Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return s(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()})}},{key:"moveLeft",value:function(){var t=this;if(this.status!==e.STATUS_WIN&&this.status!==e.STATUS_LOSE&&this.status!==e.STATUS_IDLE){for(var s=JSON.stringify(this.state),a=0;a<this.state.length;a++)!function(s){for(var a=t.state[s].filter(function(t){return 0!==t}),r=0;r<a.length-1;r++)a[r]===a[r+1]&&(a[r]*=2,a[r+1]=0,a[r]===e.WIN_NUMBER&&(t.status=e.STATUS_WIN),t.score+=a[r]);for(a=a.filter(function(t){return 0!==t});a.length<t.state[s].length;)a.push(0);t.state[s]=a}(a);s!==JSON.stringify(this.state)&&this.addRandomTile(),this.movesAvailable()||(this.status=e.STATUS_LOSE)}}},{key:"moveRight",value:function(){var t=this;if(this.status!==e.STATUS_WIN&&this.status!==e.STATUS_LOSE&&this.status!==e.STATUS_IDLE){for(var s=JSON.stringify(this.state),a=0;a<this.state.length;a++)!function(s){for(var a=t.state[s].filter(function(t){return 0!==t}),r=a.length-1;r>0;r--)a[r]===a[r-1]&&(a[r]*=2,a[r-1]=0,a[r]===e.WIN_NUMBER&&(t.status=e.STATUS_WIN),t.score+=a[r]);for(a=a.filter(function(t){return 0!==t});a.length<t.state[s].length;)a.unshift(0);t.state[s]=a}(a);s!==JSON.stringify(this.state)&&this.addRandomTile(),this.movesAvailable()||(this.status=e.STATUS_LOSE)}}},{key:"moveUp",value:function(){var t=this;if(this.status!==e.STATUS_WIN&&this.status!==e.STATUS_LOSE&&this.status!==e.STATUS_IDLE){for(var s=JSON.stringify(this.state),a=0;a<this.state[0].length;a++)!function(s){for(var a=[],r=0;r<t.state.length;r++)0!==t.state[r][s]&&a.push(t.state[r][s]);for(var n=0;n<a.length-1;n++)a[n]===a[n+1]&&(a[n]*=2,a[n+1]=0,a[n]===e.WIN_NUMBER&&(t.status=e.STATUS_WIN),t.score+=a[n]);for(a=a.filter(function(t){return 0!==t});a.length<t.state.length;)a.push(0);for(var i=0;i<t.state.length;i++)t.state[i][s]=a[i]}(a);s!==JSON.stringify(this.state)&&this.addRandomTile(),this.movesAvailable()||(this.status=e.STATUS_LOSE)}}},{key:"moveDown",value:function(){var t=this;if(this.status!==e.STATUS_WIN&&this.status!==e.STATUS_LOSE&&this.status!==e.STATUS_IDLE){for(var s=JSON.stringify(this.state),a=0;a<this.state[0].length;a++)!function(s){for(var a=[],r=0;r<t.state.length;r++)0!==t.state[r][s]&&a.push(t.state[r][s]);for(var n=a.length-1;n>0;n--)a[n]===a[n-1]&&(a[n]*=2,a[n-1]=0,a[n]===e.WIN_NUMBER&&(t.status=e.STATUS_WIN),t.score+=a[n]);for(a=a.filter(function(t){return 0!==t});a.length<t.state.length;)a.unshift(0);for(var i=0;i<t.state.length;i++)t.state[i][s]=a[i]}(a);s!==JSON.stringify(this.state)&&this.addRandomTile(),this.movesAvailable()||(this.status=e.STATUS_LOSE)}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status=e.STATUS_PLAYING,this.addRandomTile(),this.addRandomTile()}},{key:"restart",value:function(){this.state=this.deepCloneArray(this.initialState),this.score=0,this.status=e.STATUS_IDLE}},{key:"addRandomTile",value:function(){for(var t=[],e=0;e<this.state.length;e++)for(var s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push({x:e,y:s});var a=Math.floor(Math.random()*t.length),r=t[a],n=r.x,i=r.y;this.state[n][i]=.9>Math.random()?2:4}},{key:"movesAvailable",value:function(){for(var t=0;t<this.state.length;t++)for(var e=0;e<this.state[t].length;e++)if(0===this.state[t][e]||t>0&&this.state[t][e]===this.state[t-1][e]||t<this.state.length-1&&this.state[t][e]===this.state[t+1][e]||e>0&&this.state[t][e]===this.state[t][e-1]||e<this.state[t].length-1&&this.state[t][e]===this.state[t][e+1])return!0;return!1}}],function(t,e){for(var s=0;s<e.length;s++){var a=e[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(e.prototype,t),e}();e(a,"WIN_NUMBER",2048),e(a,"STATUS_PLAYING","playing"),e(a,"STATUS_IDLE","idle"),e(a,"STATUS_LOSE","lose"),e(a,"STATUS_WIN","win"),e(a,"DEFAULT_STATE",[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);var r=new(t=a),n=document.querySelector(".button"),i=document.querySelector(".game-score"),o=document.querySelectorAll(".field-cell");function l(t){switch(t.key){case"ArrowDown":r.moveDown();break;case"ArrowUp":r.moveUp();break;case"ArrowRight":r.moveRight();break;case"ArrowLeft":r.moveLeft();break;default:return}u()}function u(){var e,s;i.textContent=r.getScore(),function(){for(var t=r.getState(),e=0;e<t.length;e++)for(var s=0;s<t[e].length;s++){var a=o[e*t.length+s];a.textContent=0===t[e][s]?"":t[e][s],a.className="field-cell",0!==t[e][s]&&a.classList.add("field-cell--".concat(t[e][s]))}}(),e=r.getStatus(),(s=document.querySelector(".message-container")).querySelectorAll(".message").forEach(function(t){return t.classList.add("hidden")}),e===t.STATUS_LOSE?s.querySelector(".message-lose").classList.remove("hidden"):e===t.STATUS_WIN?s.querySelector(".message-win").classList.remove("hidden"):e===t.STATUS_IDLE&&s.querySelector(".message-start").classList.remove("hidden")}n.addEventListener("click",function(){n.classList.toggle("start"),n.classList.toggle("restart"),n.classList.contains("restart")?(n.textContent="Restart",r.start(),u(),document.addEventListener("keydown",l)):(n.textContent="Start",r.restart(),u())})}();
//# sourceMappingURL=index.967fda37.js.map
